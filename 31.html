<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åŒ–å­¸åæ‡‰éé‡å•é¡Œæ¨¡æ“¬å™¨ (å«æ¸¬é©—) - å°ç²˜è£½ä½œ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { font-family: 'Noto Sans TC', 'Microsoft JhengHei', sans-serif; }
        .molecule { transition: all 0.3s ease-in-out; }
        
        /* æ»‘æ¡¿æ¨£å¼ */
        input[type=range] { -webkit-appearance: none; background: transparent; }
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none; height: 20px; width: 20px; border-radius: 50%;
            background: #4F46E5; cursor: pointer; margin-top: -8px; 
            box-shadow: 0 2px 4px rgba(0,0,0,0.2); transition: background 0.2s;
        }
        input[type=range]::-webkit-slider-thumb:hover { background: #4338ca; }
        input[type=range]::-webkit-slider-runnable-track {
            width: 100%; height: 4px; cursor: pointer; background: #CBD5E1; border-radius: 2px;
        }
        
        .molecule-container::-webkit-scrollbar { width: 6px; }
        .molecule-container::-webkit-scrollbar-track { background: #f1f1f1; }
        .molecule-container::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 3px; }

        /* ç½²åå‹•ç•« */
        .signature-badge { animation: float 3s ease-in-out infinite; }
        @keyframes float {
            0% { transform: translateY(0px) rotate(3deg); }
            50% { transform: translateY(-5px) rotate(3deg); }
            100% { transform: translateY(0px) rotate(3deg); }
        }

        /* æ¸¬é©—é¸é …å‹•ç•« */
        .quiz-option { transition: all 0.2s; }
        .quiz-option:hover:not(:disabled) { transform: translateY(-2px); box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1); }
        .quiz-option:active:not(:disabled) { transform: translateY(0); }
    </style>
</head>
<body class="bg-slate-50 text-slate-800 p-4 md:p-8 min-h-screen flex flex-col">

    <div class="max-w-6xl mx-auto space-y-8 flex-grow w-full">

        <header class="text-center space-y-4 relative">
            <div class="flex justify-center items-center relative">
                <h1 class="text-3xl md:text-4xl font-bold text-indigo-700 tracking-tight">åŒ–å­¸åæ‡‰é™é‡è©¦åŠ‘æ¨¡æ“¬å™¨ <span class="text-lg font-normal text-slate-500 block md:inline md:ml-2">(å«ç·´ç¿’é¡Œ)</span></h1>
                <div class="hidden md:block absolute -right-4 top-0">
                    <span class="signature-badge inline-block bg-yellow-400 text-indigo-900 text-sm font-black px-3 py-1 rounded shadow-md border-2 border-indigo-900 transform rotate-3">å°ç²˜è£½ä½œ</span>
                </div>
            </div>
            <div class="md:hidden">
                <span class="bg-yellow-100 text-yellow-800 text-xs font-bold px-2 py-0.5 rounded border border-yellow-300">By å°ç²˜è£½ä½œ</span>
            </div>
            <div class="flex flex-col md:flex-row justify-center items-center gap-4">
                <p class="text-slate-600 text-lg">åæ‡‰å¼ï¼š<span class="font-mono bg-white px-2 py-1 rounded shadow-sm border border-slate-200 text-indigo-600 font-bold">2H<sub>2</sub> + 1O<sub>2</sub> &rarr; 2H<sub>2</sub>O</span></p>
                <div class="text-sm bg-slate-200 text-slate-600 px-3 py-1 rounded-full">H=1, O=16</div>
            </div>
        </header>

        <div class="bg-white rounded-2xl shadow-xl overflow-hidden border border-slate-200">
            <div class="bg-indigo-600 text-white px-6 py-3 font-bold flex items-center">
                <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19.428 15.428a2 2 0 00-1.022-.547l-2.384-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"></path></svg>
                å¯¦é©—æ¨¡æ“¬å€
            </div>
            
            <div class="p-6 space-y-8">
                <section class="border-b border-slate-100 pb-6">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                        <div class="space-y-2 group">
                            <div class="flex justify-between items-end">
                                <label class="font-bold text-slate-700">æ°«æ°£ (H<sub>2</sub>)</label>
                                <div class="text-right"><span id="h2-display" class="block bg-blue-100 text-blue-800 px-3 py-0.5 rounded-t font-mono font-bold text-lg">6 mol</span><span id="h2-mass-display" class="block bg-blue-50 text-blue-600 px-3 py-0.5 rounded-b text-xs border border-blue-100 font-mono">è³ªé‡: 12g</span></div>
                            </div>
                            <input type="range" id="h2-input" min="0" max="20" value="6" class="w-full">
                        </div>
                        <div class="space-y-2 group">
                            <div class="flex justify-between items-end">
                                <label class="font-bold text-slate-700">æ°§æ°£ (O<sub>2</sub>)</label>
                                <div class="text-right"><span id="o2-display" class="block bg-red-100 text-red-800 px-3 py-0.5 rounded-t font-mono font-bold text-lg">2 mol</span><span id="o2-mass-display" class="block bg-red-50 text-red-600 px-3 py-0.5 rounded-b text-xs border border-red-100 font-mono">è³ªé‡: 64g</span></div>
                            </div>
                            <input type="range" id="o2-input" min="0" max="10" value="2" class="w-full">
                        </div>
                    </div>
                </section>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <section class="bg-slate-50 rounded-xl border border-slate-200 overflow-hidden flex flex-col">
                        <div class="bg-slate-100 px-4 py-2 border-b border-slate-200 flex justify-between items-center"><h3 class="font-bold text-slate-700 text-sm">åæ‡‰å‰</h3></div>
                        <div id="container-before" class="molecule-container h-48 p-4 relative flex flex-wrap content-start gap-2 overflow-y-auto"></div>
                    </section>
                    <section class="bg-white rounded-xl border border-green-200 overflow-hidden flex flex-col relative shadow-sm">
                        <div class="bg-green-50 px-4 py-2 border-b border-green-100 flex justify-between items-center"><h3 class="font-bold text-green-800 text-sm">åæ‡‰å¾Œ</h3></div>
                        <div id="container-after" class="molecule-container h-48 p-4 relative flex flex-wrap content-start gap-2 overflow-y-auto"></div>
                    </section>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    <div class="lg:col-span-1 space-y-4">
                        <div class="bg-slate-50 p-4 rounded-lg text-sm space-y-2 border border-slate-200">
                            <div class="flex justify-between"><span>ç”Ÿæˆæ°´ (Hâ‚‚O):</span><span id="res-product" class="font-bold text-indigo-600">0</span></div>
                            <div class="flex justify-between"><span>å‰©é¤˜ Hâ‚‚:</span><span id="res-rem-h2" class="font-bold text-slate-600">0</span></div>
                            <div class="flex justify-between"><span>å‰©é¤˜ Oâ‚‚:</span><span id="res-rem-o2" class="font-bold text-slate-600">0</span></div>
                        </div>
                        <div class="grid grid-cols-2 gap-2 text-center text-xs">
                            <div class="bg-red-50 p-2 rounded border border-red-100"><div class="text-slate-500 mb-1">é™é‡è©¦åŠ‘</div><div id="tag-limiting" class="font-bold text-red-700">-</div></div>
                            <div class="bg-green-50 p-2 rounded border border-green-100"><div class="text-slate-500 mb-1">éé‡è©¦åŠ‘</div><div id="tag-excess" class="font-bold text-green-700">-</div></div>
                        </div>
                    </div>
                    <div class="lg:col-span-2 bg-slate-800 text-white rounded-lg p-5 text-sm leading-relaxed relative overflow-hidden flex flex-col justify-center">
                        <h3 class="font-bold text-yellow-400 mb-2">ğŸ’¡ æ€è€ƒéç¨‹</h3>
                        <div id="explanation-text" class="text-slate-200 z-10"></div>
                        <div class="absolute -right-6 -bottom-6 text-slate-700 opacity-20"><svg width="100" height="100" fill="currentColor" viewBox="0 0 24 24"><path d="M12 2L2 22h20L12 2zm0 3.8L18.4 20H5.6L12 5.8z"/></svg></div>
                    </div>
                </div>
            </div>
        </div>

        <div class="bg-white rounded-2xl shadow-xl overflow-hidden border border-slate-200 scroll-mt-10" id="quiz-section">
            <div class="bg-teal-600 text-white px-6 py-3 font-bold flex justify-between items-center">
                <div class="flex items-center">
                    <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"></path></svg>
                    è§€å¿µæŒ‘æˆ°å€ (Quiz)
                </div>
                <span id="score-display" class="text-sm bg-teal-700 px-3 py-1 rounded-full">Score: 0</span>
            </div>
            
            <div class="p-6 md:p-10 min-h-[300px] flex flex-col justify-center items-center">
                
                <div id="quiz-container" class="w-full max-w-2xl mx-auto transition-all duration-300">
                    <div class="w-full bg-slate-100 rounded-full h-2 mb-6">
                        <div id="progress-bar" class="bg-teal-500 h-2 rounded-full transition-all duration-500" style="width: 0%"></div>
                    </div>

                    <h3 id="question-text" class="text-xl md:text-2xl font-bold text-slate-800 mb-6 leading-normal">
                        </h3>

                    <div id="options-container" class="space-y-3 mb-6">
                        </div>

                    <div id="rationale-box" class="hidden bg-slate-50 border-l-4 border-slate-400 p-4 rounded text-slate-700 mb-6 animate-fade-in">
                        <p class="font-bold mb-1" id="rationale-title">è§£æï¼š</p>
                        <p id="rationale-text" class="text-sm"></p>
                    </div>

                    <div class="flex justify-end">
                        <button id="next-btn" class="hidden bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-6 rounded-lg shadow transition transform hover:scale-105 flex items-center">
                            ä¸‹ä¸€é¡Œ <svg class="w-4 h-4 ml-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6"></path></svg>
                        </button>
                    </div>
                </div>

                <div id="result-container" class="hidden text-center space-y-6 animate-fade-in">
                    <div class="text-6xl mb-4">ğŸ†</div>
                    <h2 class="text-3xl font-bold text-indigo-800">æŒ‘æˆ°å®Œæˆï¼</h2>
                    <p class="text-xl text-slate-600">ä½ çš„å¾—åˆ†ï¼š<span id="final-score" class="font-bold text-teal-600 text-3xl"></span> / <span id="total-questions"></span></p>
                    <div id="feedback-msg" class="text-slate-500"></div>
                    <button onclick="resetQuiz()" class="mt-4 bg-white border border-slate-300 text-slate-600 font-bold py-2 px-6 rounded-full hover:bg-slate-50 transition shadow-sm">
                        å†ç©ä¸€æ¬¡
                    </button>
                </div>

            </div>
        </div>

    </div>

    <footer class="mt-12 py-6 border-t border-slate-200 text-center">
        <div class="inline-block bg-white px-6 py-3 rounded-full shadow-sm border border-slate-200">
            <p class="text-slate-500 font-medium text-sm flex items-center justify-center">
                <span>Created with <span class="text-red-400">â¤</span> for Science Education</span>
                <span class="mx-3 text-slate-300">|</span>
                <span class="text-indigo-600 font-bold">å°ç²˜è£½ä½œ</span>
            </p>
        </div>
    </footer>

    <script>
        /* --- Part A: æ¨¡æ“¬å™¨é‚è¼¯ --- */
        const MW_H2=2, MW_O2=32, MW_H2O=18;
        const h2Input = document.getElementById('h2-input');
        const o2Input = document.getElementById('o2-input');
        
        function updateSimulation() {
            const h2 = parseInt(h2Input.value);
            const o2 = parseInt(o2Input.value);

            // æ›´æ–°é¡¯ç¤º
            document.getElementById('h2-display').innerText = `${h2} mol`;
            document.getElementById('h2-mass-display').innerText = `è³ªé‡: ${h2*MW_H2}g`;
            document.getElementById('o2-display').innerText = `${o2} mol`;
            document.getElementById('o2-mass-display').innerText = `è³ªé‡: ${o2*MW_O2}g`;

            // è¨ˆç®—
            const reactionCount = Math.min(Math.floor(h2/2), Math.floor(o2/1));
            const prod = reactionCount * 2;
            const remH2 = h2 - (reactionCount * 2);
            const remO2 = o2 - (reactionCount * 1);

            // åˆ¤æ–·é™é‡
            let lim="", exc="";
            if(h2===0 && o2===0){ lim="-"; exc="-"; }
            else if(Math.floor(h2/2) < Math.floor(o2/1)){ lim="æ°«æ°£ (Hâ‚‚)"; exc="æ°§æ°£ (Oâ‚‚)"; }
            else if(Math.floor(o2/1) < Math.floor(h2/2)){ lim="æ°§æ°£ (Oâ‚‚)"; exc="æ°«æ°£ (Hâ‚‚)"; }
            else { lim="ç„¡ (å®Œå…¨åæ‡‰)"; exc="ç„¡"; }

            // æ›´æ–°çµæœDOM
            document.getElementById('res-product').innerText = prod;
            document.getElementById('res-rem-h2').innerText = remH2;
            document.getElementById('res-rem-o2').innerText = remO2;
            
            const tagLim = document.getElementById('tag-limiting');
            tagLim.innerText = lim;
            tagLim.className = (lim.includes("ç„¡") || lim==="-") ? "font-bold text-slate-500" : "font-bold text-red-700";

            document.getElementById('tag-excess').innerText = exc;

            // ç¹ªåœ–
            renderMolecules(document.getElementById('container-before'), h2, 'H2', o2, 'O2');
            renderAfter(document.getElementById('container-after'), prod, remH2, remO2);

            // è§£èªª
            explain(h2, o2, prod, remH2, remO2);
        }

        function createMol(type){
            const d = document.createElement('div');
            d.className = "molecule inline-flex items-center justify-center p-2 border border-slate-200 rounded-lg bg-white shadow-sm scale-90";
            if(type==='H2') d.innerHTML = `<div class="flex space-x-0.5"><div class="w-3 h-3 rounded-full bg-blue-500"></div><div class="w-3 h-3 rounded-full bg-blue-500"></div></div><span class="ml-1 text-[10px] font-bold text-slate-400">Hâ‚‚</span>`;
            if(type==='O2') d.innerHTML = `<div class="flex space-x-0.5"><div class="w-4 h-4 rounded-full bg-red-500"></div><div class="w-4 h-4 rounded-full bg-red-500"></div></div><span class="ml-1 text-[10px] font-bold text-slate-400">Oâ‚‚</span>`;
            if(type==='H2O') d.innerHTML = `<div class="relative w-6 h-5 flex justify-center items-center"><div class="w-4 h-4 rounded-full bg-red-500 z-10"></div><div class="w-2.5 h-2.5 rounded-full bg-blue-500 absolute -top-1 -left-0.5"></div><div class="w-2.5 h-2.5 rounded-full bg-blue-500 absolute -top-1 -right-0.5"></div></div><span class="ml-1 text-[10px] font-bold text-slate-400">Hâ‚‚O</span>`;
            return d;
        }

        function renderMolecules(container, c1, t1, c2, t2){
            container.innerHTML = "";
            for(let i=0; i<c1; i++) container.appendChild(createMol(t1));
            for(let i=0; i<c2; i++) container.appendChild(createMol(t2));
        }

        function renderAfter(container, water, rh2, ro2){
            container.innerHTML = "";
            for(let i=0; i<water; i++){ let m=createMol('H2O'); m.classList.add('bg-green-50','border-green-200'); container.appendChild(m); }
            for(let i=0; i<rh2; i++){ let m=createMol('H2'); m.classList.add('opacity-40','grayscale'); container.appendChild(m); }
            for(let i=0; i<ro2; i++){ let m=createMol('O2'); m.classList.add('opacity-40','grayscale'); container.appendChild(m); }
            if(water+rh2+ro2===0) container.innerHTML = '<div class="w-full h-full flex items-center justify-center text-slate-400 text-xs italic">è«‹åŠ å…¥åæ‡‰ç‰©</div>';
        }

        function explain(h2, o2, w, rh, ro){
            const txt = document.getElementById('explanation-text');
            if(h2===0 && o2===0) { txt.innerHTML="è«‹èª¿æ•´æ»‘æ¡¿é–‹å§‹å¯¦é©—"; return; }
            const needH = o2*2;
            let html = `<p>1. ä¿‚æ•¸æ¯” Hâ‚‚:Oâ‚‚ = 2:1ã€‚ä¹Ÿå°±æ˜¯ 1å€‹æ°§æ°£éœ€è¦é… 2å€‹æ°«æ°£ã€‚</p>`;
            html += `<p>2. ç¾æœ‰ ${o2} mol æ°§æ°£ï¼Œç†è«–ä¸Šéœ€è¦ <span class="text-yellow-300 font-bold">${needH}</span> mol æ°«æ°£ã€‚</p>`;
            if(h2 < needH) html += `<p>3. ä½†ä½ åªæœ‰ ${h2} mol æ°«æ°£ (ä¸å¤ )ï¼Œæ‰€ä»¥ <span class="text-red-300 font-bold">æ°«æ°£å…ˆç”¨å®Œ (é™é‡)</span>ã€‚</p>`;
            else if(h2 > needH) html += `<p>3. ä½ æœ‰ ${h2} mol æ°«æ°£ (å¤ ç”¨é‚„æœ‰å‰©)ï¼Œæ‰€ä»¥ <span class="text-red-300 font-bold">æ°§æ°£å…ˆç”¨å®Œ (é™é‡)</span>ã€‚</p>`;
            else html += `<p>3. æ¯”ä¾‹å‰›å¥½ï¼Œå…©è€…åŒæ™‚ç”¨å®Œã€‚</p>`;
            txt.innerHTML = html;
        }

        h2Input.addEventListener('input', updateSimulation);
        o2Input.addEventListener('input', updateSimulation);
        updateSimulation();


        /* --- Part B: ç·´ç¿’é¡Œé‚è¼¯ --- */
        const questions = [
            {
                q: "é—œæ–¼ã€Œé™é‡è©¦åŠ‘ã€ï¼Œä¸‹åˆ—æ•˜è¿°ä½•è€…æ­£ç¢ºï¼Ÿ",
                options: ["è³ªé‡æœ€è¼•çš„åæ‡‰ç‰©", "ä¿‚æ•¸æœ€å°çš„åæ‡‰ç‰©", "æœ€å…ˆè¢«æ¶ˆè€—å®Œç•¢çš„åæ‡‰ç‰©", "åæ‡‰å¾Œå‰©æœ€å¤šçš„åæ‡‰ç‰©"],
                ans: 2,
                rationale: "æ­£ç¢ºï¼é™é‡è©¦åŠ‘æ±ºå®šäº†åæ‡‰ä½•æ™‚åœæ­¢ï¼Œå®ƒæ˜¯æœ€å…ˆè¢«ç”¨å…‰çš„é‚£å€‹ã€‚"
            },
            {
                q: "åæ‡‰å¼ 2A + B â†’ Cã€‚è‹¥æœ‰ 10è«è€³çš„ A å’Œ 10è«è€³çš„ Bï¼Œèª°æ˜¯é™é‡è©¦åŠ‘ï¼Ÿ",
                options: ["A", "B", "éƒ½æ˜¯", "ç„¡æ³•åˆ¤æ–·"],
                ans: 0,
                rationale: "å› ç‚ºä¿‚æ•¸æ¯” A:B = 2:1ã€‚10è«è€³çš„ B éœ€è¦ 20è«è€³çš„ A æ‰èƒ½åæ‡‰å®Œï¼Œä½† A åªæœ‰ 10ï¼Œæ‰€ä»¥ A æœƒå…ˆç”¨å®Œã€‚"
            },
            {
                q: "æ‰¿ä¸Šé¡Œ (2A + B â†’ C)ï¼Œåæ‡‰çµæŸå¾Œï¼Œæœƒç”Ÿæˆå¤šå°‘è«è€³çš„ Cï¼Ÿ(å‡è¨­ C çš„ä¿‚æ•¸æ˜¯ 1)",
                options: ["5 è«è€³", "10 è«è€³", "15 è«è€³", "20 è«è€³"],
                ans: 0,
                rationale: "ç”¢ç‰©ç”±é™é‡è©¦åŠ‘ A æ±ºå®šã€‚A æœ‰ 10è«è€³ï¼Œä¿‚æ•¸æ¯” A:C = 2:1ï¼Œæ‰€ä»¥ç”Ÿæˆ C ç‚º 10/2 = 5 è«è€³ã€‚"
            },
            {
                q: "å¦‚æœ 4g æ°«æ°£ (Hâ‚‚, åˆ†å­é‡2) èˆ‡ 32g æ°§æ°£ (Oâ‚‚, åˆ†å­é‡32) åæ‡‰ï¼Œä½•è€…éé‡ï¼Ÿ",
                options: ["æ°«æ°£éé‡", "æ°§æ°£éé‡", "å‰›å¥½å®Œå…¨åæ‡‰", "ç„¡æ³•åˆ¤æ–·"],
                ans: 2,
                rationale: "å…ˆæ›ç®—è«è€³æ•¸ï¼šæ°«æ°£ 4/2=2 molï¼Œæ°§æ°£ 32/32=1 molã€‚æ¯”ä¾‹å‰›å¥½æ˜¯ 2:1ï¼Œç¬¦åˆåæ‡‰å¼ï¼Œç„¡äººéé‡ã€‚"
            },
            {
                q: "æ ¹æ“šè³ªé‡å®ˆæ†å®šå¾‹ï¼Œåœ¨å¯†é–‰å®¹å™¨ä¸­é€²è¡Œåæ‡‰ï¼Œåæ‡‰å‰å¾Œä»€éº¼ä¸æœƒæ”¹è®Šï¼Ÿ",
                options: ["åˆ†å­çš„ç¸½æ•¸", "ç‰©è³ªçš„ç¸½è³ªé‡", "æ°£é«”çš„ç¸½é«”ç©", "ç‰©è³ªçš„é¡è‰²"],
                ans: 1,
                rationale: "è³ªé‡å®ˆæ†å®šå¾‹æŒ‡å‡ºï¼Œåæ‡‰å‰å¾ŒåŸå­çš„ç¨®é¡èˆ‡æ•¸ç›®ä¸è®Šï¼Œå› æ­¤ã€Œç¸½è³ªé‡ã€ç¶­æŒä¸è®Šã€‚"
            }
        ];

        let currentQ = 0;
        let score = 0;

        function renderQuiz() {
            const q = questions[currentQ];
            document.getElementById('question-text').innerText = `Q${currentQ+1}. ${q.q}`;
            
            const optsDiv = document.getElementById('options-container');
            optsDiv.innerHTML = "";
            
            q.options.forEach((opt, idx) => {
                const btn = document.createElement('button');
                btn.className = "quiz-option w-full text-left p-4 rounded-xl border border-slate-200 bg-white hover:bg-slate-50 text-slate-700 font-medium transition shadow-sm flex items-center group";
                btn.innerHTML = `<span class="w-8 h-8 rounded-full bg-slate-100 text-slate-500 flex items-center justify-center mr-3 text-sm font-bold group-hover:bg-indigo-100 group-hover:text-indigo-600">${String.fromCharCode(65+idx)}</span> ${opt}`;
                btn.onclick = () => checkAnswer(idx, btn);
                optsDiv.appendChild(btn);
            });

            // é€²åº¦æ¢
            document.getElementById('progress-bar').style.width = `${((currentQ)/questions.length)*100}%`;
            
            // é‡ç½®ç‹€æ…‹
            document.getElementById('rationale-box').classList.add('hidden');
            document.getElementById('next-btn').classList.add('hidden');
            document.getElementById('options-container').classList.remove('pointer-events-none');
        }

        function checkAnswer(selectedIdx, btnElement) {
            const q = questions[currentQ];
            const isCorrect = (selectedIdx === q.ans);
            
            // é–å®šé¸é …
            document.getElementById('options-container').classList.add('pointer-events-none');
            
            // é¡¯ç¤ºå°éŒ¯æ¨£å¼
            const allBtns = document.querySelectorAll('.quiz-option');
            allBtns.forEach((btn, idx) => {
                if (idx === q.ans) {
                    btn.classList.remove('bg-white', 'border-slate-200');
                    btn.classList.add('bg-green-100', 'border-green-500', 'text-green-800'); // æ­£è§£ç¶ è‰²
                    btn.innerHTML += ` <span class="ml-auto text-green-600 font-bold">âœ“</span>`;
                } else if (idx === selectedIdx && !isCorrect) {
                    btn.classList.remove('bg-white', 'border-slate-200');
                    btn.classList.add('bg-red-100', 'border-red-500', 'text-red-800'); // éŒ¯è§£ç´…è‰²
                    btn.innerHTML += ` <span class="ml-auto text-red-600 font-bold">âœ•</span>`;
                }
            });

            // æ›´æ–°åˆ†æ•¸
            if (isCorrect) {
                score++;
                document.getElementById('score-display').innerText = `Score: ${score}`;
            }

            // é¡¯ç¤ºè©³è§£
            const rBox = document.getElementById('rationale-box');
            document.getElementById('rationale-title').innerText = isCorrect ? "ğŸ‰ ç­”å°äº†ï¼" : "ğŸ’ª å†æ¥å†å²ï¼";
            document.getElementById('rationale-title').className = isCorrect ? "font-bold mb-1 text-green-700" : "font-bold mb-1 text-red-700";
            document.getElementById('rationale-text').innerText = q.rationale;
            rBox.classList.remove('hidden'); // é¡¯ç¤ºè©³è§£

            // é¡¯ç¤ºä¸‹ä¸€é¡ŒæŒ‰éˆ•
            const nextBtn = document.getElementById('next-btn');
            nextBtn.classList.remove('hidden');
            
            if (currentQ === questions.length - 1) {
                nextBtn.innerHTML = "æŸ¥çœ‹çµæœ";
                nextBtn.onclick = showResult;
            } else {
                nextBtn.innerHTML = `ä¸‹ä¸€é¡Œ <svg class="w-4 h-4 ml-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6"></path></svg>`;
                nextBtn.onclick = () => { currentQ++; renderQuiz(); };
            }
        }

        function showResult() {
            document.getElementById('quiz-container').classList.add('hidden');
            document.getElementById('result-container').classList.remove('hidden');
            document.getElementById('final-score').innerText = score;
            document.getElementById('total-questions').innerText = questions.length;
            
            let msg = "";
            if(score === questions.length) msg = "å¤ªå²å®³äº†ï¼ä½ æ˜¯åŒ–å­¸è¨ˆé‡å¤§å¸«ï¼ğŸ“";
            else if(score >= questions.length/2) msg = "ä¸éŒ¯å–”ï¼è§€å¿µå·²ç¶“å¾ˆæ¸…æ¥šäº†ã€‚ğŸ‘";
            else msg = "åˆ¥æ°£é¤’ï¼Œå¤šç©å¹¾æ¬¡æ¨¡æ“¬å™¨å°±æ‡‚å›‰ï¼ğŸ’¡";
            document.getElementById('feedback-msg').innerText = msg;
        }

        function resetQuiz() {
            currentQ = 0;
            score = 0;
            document.getElementById('score-display').innerText = `Score: 0`;
            document.getElementById('result-container').classList.add('hidden');
            document.getElementById('quiz-container').classList.remove('hidden');
            renderQuiz();
        }

        // åˆå§‹åŒ–
        renderQuiz();

    </script>
</body>
</html>